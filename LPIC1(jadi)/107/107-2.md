# LPIC-1: Session 28 - Automate System Administration with Cron, At, and systemd

## ğŸŒŸ Objectives
- Use cron and at for job scheduling
- Understand system-wide and user-specific cron jobs
- Configure access to cron and at
- Utilize systemd timers

---

## â° Cron Jobs

### âœï¸ Crontab Syntax
```text
A B C D E command
| | | | |
| | | | +---- Day of week (0-7 or sun-sat)
| | | +------ Month (1-12 or jan-dec)
| | +-------- Day of month (1-31)
| +---------- Hour (0-23)
+------------ Minute (0-59)
```

### ğŸ”¹ Examples
```bash
*/5 * * * * echo "every 5 minutes"
42 8,18 * * 1-5 echo "8:42 & 18:42 on weekdays"
@reboot echo "after reboot"
```

### ğŸ”¹ Manage User Crons
```bash
crontab -l     # List
crontab -e     # Edit
crontab -r     # Remove
```
Files are stored in: `/var/spool/cron/crontabs/`

---

## ğŸŒ System Cron

### `/etc/crontab` format:
```text
A B C D E USER command
```

### ğŸ”¹ Periodic Directories
- `/etc/cron.hourly/`
- `/etc/cron.daily/`
- `/etc/cron.weekly/`
- `/etc/cron.monthly/`

Place scripts in these dirs to run them on set intervals.

---

## ğŸ“† at: Run Job Once in Future
```bash
at now + 1 min
at> touch /tmp/at_test
at> <Ctrl+D>
```
### Manage at Jobs:
```bash
atq    # List
atrm # Remove by job ID
```

---

## ğŸš« Restricting Access to Cron and At
- `/etc/cron.allow`, `/etc/cron.deny`
- `/etc/at.allow`, `/etc/at.deny`

| File       | Behavior |
|------------|----------|
| `*.allow` | Only listed users allowed |
| `*.deny`  | Listed users denied       |

---

## âŒ› systemd Timers

### ğŸ”¹ Timer Unit Format:
```ini
[Unit]
Description=My timer

[Timer]
OnCalendar=Sat *-*-1..7 02:42:00
Persistent=true

[Install]
WantedBy=timers.target
```

### â³ Monotonic Timers
```ini
[Timer]
OnActiveSec=5min 20s
```
Other options: `OnBootSec`, `OnStartupSec`, `OnUnitActiveSec`, `OnUnitInactiveSec`

### ğŸ”¹ Manage Timers
```bash
systemctl enable myjob.timer
systemctl start myjob.timer
systemctl list-timers --all
```

### ğŸ”¹ Run Jobs with `systemd-run`
```bash
systemd-run --on-active="2h" /path/to/script.sh
```

---

This concludes **Session 28** of LPIC-1: Job Scheduling with Cron, At, and systemd â°
